{"ast":null,"code":"var _jsxFileName = \"/Users/karentovar/Documents/WebCitas/WebCitas/frontend/src/pages/User/Register.js\",\n    _s = $RefreshSig$();\n\nimport { useState, useEffect } from \"react\";\nimport axios from \"axios\";\nimport \"./Register.css\";\nimport Controls from \"../../components/controls/Controls\";\nimport React from 'react';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport Fade from '@material-ui/core/Fade';\nimport { makeStyles } from '@material-ui/core/styles';\nimport HelpIcon from '@mui/icons-material/Help';\nimport Grid from '@mui/material/Grid';\nimport Tooltip from '@mui/material/Tooltip';\nimport { useForm, Form } from '../../components/useForm';\nimport AlertMessage from '../../components/AlertMessage';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst initialValues = {\n  username: '',\n  email: '',\n  password: '',\n  confirmPassword: '',\n  type: 'user',\n  roles: []\n};\nconst useStyles = makeStyles({\n  inputField: {\n    width: \"100%\",\n    marginBottom: \"20px\"\n  },\n  programholder: {\n    height: 40,\n    textAlign: 'center'\n  }\n});\n\nconst Register = _ref => {\n  _s();\n\n  let {} = _ref;\n  const classes = useStyles();\n  const [loading, setLoading] = React.useState(false);\n  const [error, setError] = useState(\"\");\n  const [open, setOpen] = React.useState(false); // const [items, setItems] = React.useState([{ name: \"\" }]);\n  // const [selected, setSelected] = React.useState(false);  \n  // const [inputProject, setInputProject] = React.useState('');\n\n  const config = {\n    headers: {\n      \"Content-Type\": \"application/json\",\n      Authorization: `Bearer ${localStorage.getItem(\"authToken\")}`\n    }\n  }; // function wrapValues(projects) {\n  //   setItems(projects);\n  //   setLoading(false);\n  // }\n\n  useEffect(() => {\n    let unmounted = false; // async function getBio() {\n    //   try {\n    //     const projects = await axios.get(\n    //       process.env.REACT_APP_API_URL + \"/api/private/project\",\n    //       config\n    //     );\n    //     wrapValues(projects.data.projects);\n    //   } catch (error) {\n    //     setTimeout(() => {\n    //       setError(\"\");\n    //     }, 5000);\n    //     return setError(\"Authentication failed!\");\n    //   }\n    // }\n    //getBio();\n\n    return () => {\n      unmounted = true;\n    };\n  }, []); // const [value, setValue] = React.useState(items[0]);\n  // const [inputValue, setInputValue] = React.useState('');\n  // const roleItems = [\n  //   { id: 'investigador', title: 'Investigador' },\n  //   { id: 'asistente', title: 'Asistente' },\n  // ]\n\n  const typeItems = [{\n    id: 'user',\n    title: 'Usuario'\n  }, {\n    id: 'admin',\n    title: 'Administrador'\n  }, {\n    id: 'gestor',\n    title: 'Gestor'\n  }];\n\n  const registerHandler = async e => {\n    e.preventDefault();\n\n    if (validate()) {\n      setLoading(true);\n\n      if (values.password !== values.confirmPassword) {\n        setValues({ ...values,\n          password: \"\",\n          confirmPassword: \"\"\n        });\n        setTimeout(() => {\n          setError(\"\");\n        }, 5000);\n        setLoading(false);\n        return setError(\"Las contrase単as no coinciden\");\n      } // if (selected === false && type === 'user') {\n      //   setTimeout(() => {\n      //     setError(\"\");\n      //   }, 5000);\n      //   setLoading(false);\n      //   return setError(\"Seleccione un proyecto\");\n      // }\n\n\n      try {\n        // const role = {\n        //   projectId: value.id,\n        //   role: roleType\n        // }\n        console.log(values);\n        const {\n          data\n        } = await axios.post(process.env.REACT_APP_API_URL + \"/api/private/register\", values, config);\n        setLoading(false);\n        setOpen(true);\n        resetForm({});\n        setTimeout(function () {\n          setOpen(false);\n        }, 6000);\n      } catch (error) {\n        console.log(error);\n        setError(error.response.data.error);\n        setTimeout(() => {\n          setError(\"\");\n        }, 5000);\n        setLoading(false);\n      }\n    }\n  };\n\n  const validate = function () {\n    let fieldValues = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : values;\n    let temp = { ...errors\n    };\n    if ('username' in fieldValues) temp.username = fieldValues.username ? \"\" : \"Este campo es obligatorio.\";\n    if ('email' in fieldValues) temp.email = fieldValues.email ? \"\" : \"Este campo es obligatorio.\";\n    if ('password' in fieldValues) temp.password = fieldValues.password ? \"\" : \"Este campo es obligatorio.\";\n    if ('confirmPassword' in fieldValues) temp.confirmPassword = fieldValues.confirmPassword ? \"\" : \"Este campo es obligatorio.\";\n    setErrors({ ...temp\n    });\n    if (fieldValues === values) return Object.values(temp).every(x => x === \"\");\n  };\n\n  const {\n    values,\n    setValues,\n    errors,\n    setErrors,\n    handleInputChange,\n    resetForm\n  } = useForm(initialValues, true, validate);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"register-screen\",\n    style: {\n      width: '90%'\n    },\n    children: /*#__PURE__*/_jsxDEV(Form, {\n      onSubmit: registerHandler,\n      className: \"register-screen__form\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: classes.programholder,\n        hidden: !loading,\n        children: [/*#__PURE__*/_jsxDEV(Fade, {\n          in: loading,\n          style: {\n            transitionDelay: '0m'\n          },\n          unmountOnExit: true,\n          children: /*#__PURE__*/_jsxDEV(CircularProgress, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 180,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 173,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 182,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 172,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(AlertMessage, {\n        errorMessage: error,\n        successMessage: \"Se ha creado un nuevo usuario!\",\n        openMessage: open\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 184,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n        className: \"register-screen__title\",\n        children: \"Crear una cuenta\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 185,\n        columnNumber: 9\n      }, this), error && /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"error-message\",\n        children: error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 186,\n        columnNumber: 19\n      }, this), /*#__PURE__*/_jsxDEV(Grid, {\n        item: true,\n        xs: 12,\n        children: [/*#__PURE__*/_jsxDEV(Controls.Input, {\n          name: \"username\",\n          label: \"Usuario\",\n          type: \"text\",\n          value: values.username,\n          onChange: handleInputChange,\n          className: classes.inputField,\n          error: errors.username\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 188,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Controls.Input, {\n          name: \"email\",\n          label: \"Email\",\n          type: \"email\",\n          value: values.email,\n          onChange: handleInputChange,\n          className: classes.inputField,\n          error: errors.email\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 197,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Controls.Input, {\n          name: \"password\",\n          label: \"Contrase\\xF1a\",\n          type: \"password\",\n          value: values.password,\n          onChange: handleInputChange,\n          className: classes.inputField,\n          error: errors.password\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 206,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Controls.Input, {\n          name: \"confirmPassword\",\n          label: \"Confirmar Contrase\\xF1a\",\n          type: \"password\",\n          value: values.confirmPassword,\n          onChange: handleInputChange,\n          className: classes.inputField,\n          error: errors.confirmPassword\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 215,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 187,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Grid, {\n        container: true,\n        children: [/*#__PURE__*/_jsxDEV(Grid, {\n          item: true,\n          children: /*#__PURE__*/_jsxDEV(Controls.RadioGroup, {\n            name: \"type\",\n            label: \"Tipo de usuario\",\n            value: values.type // onChange={(e) => {\n            //   setType(e.target.value);\n            //   if (type === 'admin')\n            //     setUser(false);\n            //   else\n            //     setUser(true);\n            // }}\n            ,\n            onChange: handleInputChange,\n            items: typeItems\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 227,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 226,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Grid, {\n          item: true,\n          children: /*#__PURE__*/_jsxDEV(Tooltip, {\n            title: \"El administrador tiene acceso a todas las funcionalidades del sistema, mientras un usuario tiene acceso limitado asociado a un proyecto.\",\n            children: /*#__PURE__*/_jsxDEV(HelpIcon, {\n              color: \"success\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 244,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 243,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 242,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 225,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 282,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"submit\",\n        className: \"btn btn-primary\",\n        children: \"Registrar Cuenta\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 283,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 171,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 169,\n    columnNumber: 5\n  }, this);\n};\n\n_s(Register, \"bvsyaIKAz4oM6dnxd5uQa6qYoQk=\", false, function () {\n  return [useStyles, useForm];\n});\n\n_c = Register;\nexport default Register;\n\nvar _c;\n\n$RefreshReg$(_c, \"Register\");","map":{"version":3,"sources":["/Users/karentovar/Documents/WebCitas/WebCitas/frontend/src/pages/User/Register.js"],"names":["useState","useEffect","axios","Controls","React","CircularProgress","Fade","makeStyles","HelpIcon","Grid","Tooltip","useForm","Form","AlertMessage","initialValues","username","email","password","confirmPassword","type","roles","useStyles","inputField","width","marginBottom","programholder","height","textAlign","Register","classes","loading","setLoading","error","setError","open","setOpen","config","headers","Authorization","localStorage","getItem","unmounted","typeItems","id","title","registerHandler","e","preventDefault","validate","values","setValues","setTimeout","console","log","data","post","process","env","REACT_APP_API_URL","resetForm","response","fieldValues","temp","errors","setErrors","Object","every","x","handleInputChange","transitionDelay"],"mappings":"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","sourcesContent":["import { useState, useEffect } from \"react\";\r\nimport axios from \"axios\";\r\nimport \"./Register.css\";\r\nimport Controls from \"../../components/controls/Controls\";\r\nimport React from 'react'\r\nimport CircularProgress from '@material-ui/core/CircularProgress';\r\nimport Fade from '@material-ui/core/Fade';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport HelpIcon from '@mui/icons-material/Help';\r\nimport Grid from '@mui/material/Grid'\r\nimport Tooltip from '@mui/material/Tooltip';\r\nimport { useForm, Form } from '../../components/useForm';\r\nimport AlertMessage from '../../components/AlertMessage';\r\n\r\nconst initialValues = {\r\n  username: '',\r\n  email: '',\r\n  password: '',\r\n  confirmPassword: '',\r\n  type: 'user',\r\n  roles: [],\r\n}\r\n\r\nconst useStyles = makeStyles(({\r\n  inputField: {\r\n    width:\"100%\",\r\n    marginBottom: \"20px\"\r\n  },\r\n  programholder: {\r\n    height: 40,\r\n    textAlign: 'center'\r\n  }\r\n}))\r\n\r\nconst Register = ({ }) => {\r\n  const classes = useStyles();\r\n\r\n  const [loading, setLoading] = React.useState(false);\r\n  const [error, setError] = useState(\"\");\r\n  const [open, setOpen] = React.useState(false);\r\n  // const [items, setItems] = React.useState([{ name: \"\" }]);\r\n  // const [selected, setSelected] = React.useState(false);  \r\n  // const [inputProject, setInputProject] = React.useState('');\r\n\r\n  const config = {\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n      Authorization: `Bearer ${localStorage.getItem(\"authToken\")}`,\r\n    },\r\n  };\r\n  // function wrapValues(projects) {\r\n  //   setItems(projects);\r\n  //   setLoading(false);\r\n\r\n  // }\r\n  useEffect(() => {\r\n    let unmounted = false;\r\n    // async function getBio() {\r\n    //   try {\r\n    //     const projects = await axios.get(\r\n    //       process.env.REACT_APP_API_URL + \"/api/private/project\",\r\n    //       config\r\n    //     );\r\n    //     wrapValues(projects.data.projects);\r\n\r\n\r\n    //   } catch (error) {\r\n    //     setTimeout(() => {\r\n    //       setError(\"\");\r\n    //     }, 5000);\r\n    //     return setError(\"Authentication failed!\");\r\n    //   }\r\n    // }\r\n    //getBio();\r\n    return () => { unmounted = true; };\r\n  }, []);\r\n\r\n  // const [value, setValue] = React.useState(items[0]);\r\n  // const [inputValue, setInputValue] = React.useState('');\r\n\r\n  // const roleItems = [\r\n  //   { id: 'investigador', title: 'Investigador' },\r\n  //   { id: 'asistente', title: 'Asistente' },\r\n  // ]\r\n\r\n  const typeItems = [\r\n    { id: 'user', title: 'Usuario' },\r\n    { id: 'admin', title: 'Administrador' },\r\n    { id: 'gestor', title: 'Gestor' },\r\n  ]\r\n\r\n  const registerHandler = async (e) => {\r\n    e.preventDefault();\r\n    if(validate()){\r\n      setLoading(true);\r\n      if (values.password !== values.confirmPassword) {\r\n        setValues({...values, password: \"\", confirmPassword: \"\"});\r\n        setTimeout(() => {\r\n          setError(\"\");\r\n        }, 5000);\r\n        setLoading(false);\r\n        return setError(\"Las contrase単as no coinciden\");\r\n      }\r\n    // if (selected === false && type === 'user') {\r\n\r\n    //   setTimeout(() => {\r\n    //     setError(\"\");\r\n    //   }, 5000);\r\n    //   setLoading(false);\r\n    //   return setError(\"Seleccione un proyecto\");\r\n    // }\r\n\r\n\r\n      try {\r\n        // const role = {\r\n        //   projectId: value.id,\r\n        //   role: roleType\r\n        // }\r\n        console.log(values);\r\n        const { data } = await axios.post(\r\n          process.env.REACT_APP_API_URL + \"/api/private/register\",values,config\r\n        );\r\n        setLoading(false);\r\n        setOpen(true);\r\n        resetForm({})\r\n        setTimeout(function () {\r\n          setOpen(false);\r\n        }, 6000);\r\n      } catch (error) {\r\n        console.log(error);\r\n        setError(error.response.data.error);\r\n        setTimeout(() => {\r\n          setError(\"\");\r\n        }, 5000);\r\n        setLoading(false);\r\n      }\r\n    }\r\n\r\n  };\r\n\r\n  const validate = (fieldValues = values) => {\r\n    let temp = { ...errors }\r\n    if ('username' in fieldValues)\r\n      temp.username = fieldValues.username ? \"\" : \"Este campo es obligatorio.\"\r\n    if ('email' in fieldValues)\r\n      temp.email = fieldValues.email ? \"\" : \"Este campo es obligatorio.\"\r\n    if ('password' in fieldValues)\r\n      temp.password = fieldValues.password ? \"\" : \"Este campo es obligatorio.\"\r\n    if ('confirmPassword' in fieldValues)\r\n      temp.confirmPassword = fieldValues.confirmPassword ? \"\" : \"Este campo es obligatorio.\"\r\n    setErrors({\r\n      ...temp\r\n    })\r\n\r\n    if (fieldValues === values)\r\n      return Object.values(temp).every(x => x === \"\")\r\n  }\r\n\r\n  const {\r\n    values,\r\n    setValues,\r\n    errors,\r\n    setErrors,\r\n    handleInputChange,\r\n    resetForm\r\n  } = useForm(initialValues, true, validate);\r\n\r\n  return (\r\n    <div className=\"register-screen\" style={{width:'90%'}}>\r\n      {/* <form onSubmit={registerHandler} className=\"register-screen__form\"> */}\r\n      <Form onSubmit={registerHandler} className=\"register-screen__form\">\r\n        <div className={classes.programholder} hidden={!loading}>\r\n          <Fade\r\n            in={loading}\r\n            style={{\r\n              transitionDelay: '0m',\r\n            }}\r\n            unmountOnExit\r\n          >\r\n            <CircularProgress />\r\n          </Fade>\r\n          <br />\r\n        </div>\r\n        <AlertMessage errorMessage={error} successMessage={\"Se ha creado un nuevo usuario!\"} openMessage={open}/>\r\n        <h3 className=\"register-screen__title\">Crear una cuenta</h3>\r\n        {error && <span className=\"error-message\">{error}</span>}\r\n        <Grid item xs={12}>\r\n          <Controls.Input\r\n            name=\"username\"\r\n            label=\"Usuario\"\r\n            type=\"text\"\r\n            value={values.username}\r\n            onChange={handleInputChange}\r\n            className={classes.inputField}\r\n            error={errors.username}\r\n          />\r\n          <Controls.Input\r\n            name=\"email\"\r\n            label=\"Email\"\r\n            type=\"email\"\r\n            value={values.email}\r\n            onChange={handleInputChange}\r\n            className={classes.inputField}\r\n            error={errors.email}\r\n          />\r\n          <Controls.Input\r\n            name=\"password\"\r\n            label=\"Contrase単a\"\r\n            type=\"password\"\r\n            value={values.password}\r\n            onChange={handleInputChange}\r\n            className={classes.inputField}\r\n            error={errors.password}\r\n          />\r\n          <Controls.Input\r\n            name=\"confirmPassword\"\r\n            label=\"Confirmar Contrase単a\"\r\n            type=\"password\"\r\n            value={values.confirmPassword}\r\n            onChange={handleInputChange}\r\n            className={classes.inputField}\r\n            error={errors.confirmPassword}\r\n          />\r\n        </Grid>\r\n        <Grid container>\r\n          <Grid item>\r\n            <Controls.RadioGroup\r\n              name=\"type\"\r\n              label=\"Tipo de usuario\"\r\n              value={values.type}\r\n              // onChange={(e) => {\r\n              //   setType(e.target.value);\r\n              //   if (type === 'admin')\r\n              //     setUser(false);\r\n              //   else\r\n              //     setUser(true);\r\n              // }}\r\n              onChange={handleInputChange}\r\n              items={typeItems}\r\n            />\r\n          </Grid>\r\n          <Grid item>\r\n            <Tooltip title=\"El administrador tiene acceso a todas las funcionalidades del sistema, mientras un usuario tiene acceso limitado asociado a un proyecto.\">\r\n              <HelpIcon color={\"success\"} />\r\n            </Tooltip>\r\n\r\n          </Grid>\r\n        </Grid>\r\n        {/* <br />\r\n        <div hidden={isUser}>\r\n          <Autocomplete\r\n            value={value}\r\n            onChange={(event, newValue) => {\r\n              setValue(newValue);\r\n              setSelected(true);\r\n            }}\r\n            inputValue={inputValue}\r\n            onInputChange={(event, newInputValue) => {\r\n              setInputValue(newInputValue);\r\n            }}\r\n            id=\"combo-box-demo\"\r\n            options={items}\r\n            getOptionLabel={(option) => option.name}\r\n            style={{ width: 300 }}\r\n            renderInput={(params) => <TextField {...params} label=\"Proyectos\" variant=\"outlined\" />}\r\n            disabled={loading}\r\n            disableClearable\r\n            inputValue={inputProject}\r\n            onInputChange={(event, newInputValue) => {\r\n              setInputProject(newInputValue);\r\n            }}\r\n          />\r\n          <br />\r\n          <Controls.RadioGroup\r\n            name=\"role\"\r\n            label=\"Tipo de rol\"\r\n            value={roleType}\r\n            onChange={(e) => { setRole(e.target.value); }}\r\n            items={roleItems}\r\n          />\r\n        </div>*/}\r\n        <br />\r\n        <button type=\"submit\" className=\"btn btn-primary\">\r\n          Registrar Cuenta\r\n        </button>\r\n      </Form>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Register;\r\n"]},"metadata":{},"sourceType":"module"}